<link rel="import" href="../polymer/polymer.html">

<!--
Web component wrapper for embedding SoundCloud tracks. [**Live demo**](../sc-embed/demo.html)

<iframe src="http://ghbtns.com/github-btn.html?user=karan&repo=sc-embed&type=watch&count=true&size=large" allowtransparency="true" frameborder="0" scrolling="0" width="170" height="30"></iframe>

##### Example

    <sc-embed href="149178712" width="50%" auto_play="true"></sc-embed>

@element sc-embed
@blurb Web component wrapper for embedding SoundCloud tracks
@status alpha
@homepage http://karan.github.io/sc-embed
-->
<polymer-element name="sc-embed" attributes="href width height auto_play query">
  <template>
    
  </template>
</polymer-element>

<script>
  Polymer('sc-embed', {

    client_id: 'c2931feadf4c308eb4ccdc7f4a6a3600',

    /**
     * The track ID of the song to play
     * 
     * @attribute href
     * @type string
     */
    href: null,

    /**
     * The width of the widget.
     * 
     * @attribute width
     * @type string
     */
    width: "100%",

    /**
     * The height of the widget.
     * 
     * @attribute height
     * @type string
     */
    height: "200px",

    /**
     * Auto plays the track on widget load if set to `true`. Defaults to 
     * `false`. Can be omitted.
     * 
     * @attribute auto_play
     * @type boolean
     */
    auto_play: false,

    /**
     * Plays a track by searching SoundCloud for this query. Can be 
     * omitted. If both `href` and `query` are provided, `href` has 
     * higher preference.
     * 
     * @attribute query
     * @type string
     */
    // query: '',

    ready: function() {
      if (!this.href) {
        SC.initialize({
          client_id: this.client_id
        });

        SC.get('/tracks', { q: this.query, limit: 1 }, function(tracks) {
          this.href = tracks[0].id;
          this.appendChild('<iframe width="this.width" height="this.height" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https://api.soundcloud.com/tracks/this.href&amp;auto_play=this.auto_play&amp;hide_related=false&amp;visual=true"></iframe>');
        });
      }
    }

  });
</script>
